import{j as e,r as x,m as Z,u as ee,Q as w}from"./index-af889cc1.js";import{d as ae}from"./GridView-81a883b8.js";import{c as ne}from"./chidoanApi-f62ed492.js";import{d as z}from"./Search-2a58d6d5.js";import{u as le,C as q}from"./index.esm-c3d487d5.js";import{d as se}from"./Close-b74d4c7a.js";import{S as M}from"./react-select.esm-34b6099d.js";import{C as te,d as ie}from"./FileDownload-0dedbaf1.js";import{t as O}from"./thongkeApi-56a36351.js";import{c as C,d as l,e as k,f as Q,P as H,h as K,i as W,j as A,k as E,u as F,a as L,I as m,l as N,m as P,n as v,o as S}from"./LastPage-dd44c61f.js";import{d as oe}from"./dayjs.min-f7728a8e.js";import{B as T}from"./Button-37b8afe6.js";import"./createSvgIcon-c7fd463f.js";import"./ButtonBase-df984b9e.js";import"./Link-f05ffa2b.js";const re=({row:s,page:n,rowsPerPage:c,index:a})=>e.jsxs(C,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(l,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:n*c+a}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:s.soQD})}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:s.hinhthuc}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:s.nguoiky}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:s.canhanbikiluat.hoten}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:oe(s.ngayky).format("DD/MM/YYYY")}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:s.noidung}),e.jsx(l,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:e.jsx(T,{variant:"contained",color:"info",size:"small",onClick:()=>window.open(`/dashboard/thong-tin-doan-vien/${s.canhanbikiluat._id}`,"_blank","noreferrer"),children:"Trang cá nhân"})})]},s._id);function V(s){const n=F(),{count:c,page:a,rowsPerPage:g,onPageChange:o}=s,p=t=>{o(t,0)},d=t=>{o(t,a-1)},i=t=>{o(t,a+1)},u=t=>{o(t,Math.max(0,Math.ceil(c/g)-1))};return e.jsxs(L,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(m,{onClick:p,disabled:a===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(N,{}):e.jsx(P,{})}),e.jsx(m,{onClick:d,disabled:a===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(v,{}):e.jsx(S,{})}),e.jsx(m,{onClick:i,disabled:a>=Math.ceil(c/g)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx(S,{}):e.jsx(v,{})}),e.jsx(m,{onClick:u,disabled:a>=Math.ceil(c/g)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(P,{}):e.jsx(N,{})})]})}V.propTypes={count:k.number.isRequired,onPageChange:k.func.isRequired,page:k.number.isRequired,rowsPerPage:k.number.isRequired};function ce({list:s}){const[n,c]=x.useState(0),[a,g]=x.useState(10),o=n>0?Math.max(0,(1+n)*a-s.length):0,p=(i,u)=>{c(u)},d=i=>{g(parseInt(i.target.value,10)),c(0)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{component:H,children:e.jsxs(K,{"aria-label":"custom pagination table",children:[e.jsx(W,{children:e.jsxs(C,{children:[e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Số quyết định"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Hình thức"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Người ký"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Cá nhân bị kỉ luật"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Ngày ký"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(30, 41, 59 )"},children:"Nội dung kỉ luật"}),e.jsx(l,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(A,{children:[(a>0?s.slice(n*a,n*a+a):s).map((i,u)=>e.jsx(re,{row:i,page:n,rowsPerPage:a,index:u+1},i._id)),o>0&&e.jsx(C,{style:{height:53*o},children:e.jsx(l,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(E,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:s.length,rowsPerPage:a,page:n,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:p,onRowsPerPageChange:d,ActionsComponent:V,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:u,to:t,count:f}){return`hiển thị ${u} đến ${t} bản ghi trong tổng số ${f!==-1?f:`more than ${t}`} bản ghi`}})})]})}function I(s){const n=F(),{count:c,page:a,rowsPerPage:g,onPageChange:o}=s,p=t=>{o(t,0)},d=t=>{o(t,a-1)},i=t=>{o(t,a+1)},u=t=>{o(t,Math.max(0,Math.ceil(c/g)-1))};return e.jsxs(L,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(m,{onClick:p,disabled:a===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(N,{}):e.jsx(P,{})}),e.jsx(m,{onClick:d,disabled:a===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(v,{}):e.jsx(S,{})}),e.jsx(m,{onClick:i,disabled:a>=Math.ceil(c/g)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx(S,{}):e.jsx(v,{})}),e.jsx(m,{onClick:u,disabled:a>=Math.ceil(c/g)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(P,{}):e.jsx(N,{})})]})}I.propTypes={count:k.number.isRequired,onPageChange:k.func.isRequired,page:k.number.isRequired,rowsPerPage:k.number.isRequired};function de({list:s}){const[n,c]=x.useState(0),[a,g]=x.useState(10);n>0&&Math.max(0,(1+n)*a-s.length);const o=(d,i)=>{c(i)},p=d=>{g(parseInt(d.target.value,10)),c(0)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{component:H,children:e.jsxs(K,{"aria-label":"custom pagination table",children:[e.jsx(W,{children:e.jsxs(C,{children:[e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Họ và tên"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Số lượt bị kỉ luật"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Chi tiết"})]})}),e.jsx(A,{children:(a>0?s.slice(n*a,n*a+a):s).map((d,i)=>e.jsxs(C,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(l,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:n*a+i+1}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:d.hoten})}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:d.soluotkiluat}),e.jsx(l,{className:"border-r border-slate-300",align:"right",children:e.jsx(T,{variant:"contained",color:"info",size:"small",onClick:()=>window.open(`/dashboard/thong-tin-doan-vien/${d._id}`,"_blank","noreferrer"),children:"Trang cá nhân"})})]},d._id))})]})}),e.jsx("div",{children:e.jsx(E,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:s.length,rowsPerPage:a,page:n,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:o,onRowsPerPageChange:p,ActionsComponent:I,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:u,count:t}){return`hiển thị ${i} đến ${u} bản ghi trong tổng số ${t!==-1?t:`more than ${u}`} bản ghi`}})})]})}let he=[{label:"STT",key:"stt"},{label:"Số quyết định",key:"soQD"},{label:"Hình thức",key:"hinhthuc"},{label:"Người ký",key:"nguoiky"},{label:"Cá nhân bị kỉ luật",key:"canhanbikiluat"},{label:"Ngày ký",key:"ngayky"},{label:"Nội dung",key:"noidung"}];const Re=()=>{const[s,n]=x.useState([]),[c,a]=x.useState([]),[g,o]=x.useState(!1),[p,d]=x.useState([]);let[i,u]=x.useState([]);const[t,f]=Z(),[D,R]=x.useState([]),[Y,X]=x.useState(!1),$=ee();x.useEffect(()=>{(async()=>{try{let h=await ne.getChidoanOfUser();a(h.data.map(r=>({label:r.tenchidoan,value:r._id}))),d([{label:"Tất cả",value:""}].concat(h.data.map(r=>({value:r._id,label:r.tenchidoan}))))}catch(h){h.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&($("/login"),w.error(h.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(h.message)}})()},[]);const{register:y,handleSubmit:U,control:B,resetField:ue,setValue:ge,watch:_,formState:{errors:xe}}=le({defaultValues:{hinhthuc:{label:"Tất cả",value:""},nhomchidoanduockhenthuong:{label:"Tất cả",value:""},tungay:"",denngay:"",soQD:"",noidung:"",nguoiky:""}}),G=async b=>{let h={...b,hinhthuc:b.hinhthuc.value,nhomchidoanduockhenthuong:b.nhomchidoanduockhenthuong.value};f(!0);let r=await O.getKiluats(h);n(r.data.data),u(r.data.data.map((j,J)=>({stt:J+1,soQD:j.soQD,ngayky:j.ngayky,noidung:j.noidung,nguoiky:j.nguoiky,hinhthuc:j.hinhthuc,canhanbikiluat:j.canhanbikiluat.hoten}))),R(r.data.canhanbikiluats),f(!1),w.success(r.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})};return x.useEffect(()=>{(async()=>{try{f(!0);let h=await O.getKiluats({tungay:"",denngay:"",nhomchidoanduockhenthuong:"",hinhthuc:"",soQD:"",nguoiky:"",noidung:""});n(h.data.data),u(h.data.data.map((r,j)=>({stt:j+1,soQD:r.soQD,ngayky:r.ngayky,noidung:r.noidung,nguoiky:r.nguoiky,hinhthuc:r.hinhthuc,canhanbikiluat:r.canhanbikiluat.hoten}))),R(h.data.canhanbikiluats),setTimeout(()=>{f(!1)},400)}catch(h){h.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&($("/login"),f(!1),w.error(h.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(h.message)}})()},[]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý khen thưởng đối với tập thể chi đoàn, liên chi đoàn"})]}),e.jsxs("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:[e.jsxs(T,{sx:{width:"300px",backgroundColor:"darkgray"},onClick:()=>o(!0),color:"info",variant:"contained",children:[e.jsx(z,{})," Chức năng tìm kiếm nâng cao"]}),e.jsx(m,{children:e.jsx(te,{data:i,headers:he,filename:`danhsachkiluat_${_("tungay")}_${_("denngay")}`,children:e.jsxs("div",{className:"flex items-center shadow-md space-x-2 bg-green-300 px-2 py-1 rounded-md",children:[e.jsx(ie,{}),e.jsx("span",{className:"text-sm text-green-800",children:"Xuất file excel"})]})})})]}),g&&e.jsxs("form",{onSubmit:U(G),className:"my-2 mt-4 mx-8 bg-slate-100 p-4 rounded-lg shadow-xl","data-aos":"zoom-in-down","data-aos-once":"true",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h5",{className:"text-[18px] font-semibold",children:"Tìm kiếm nâng cao"}),e.jsx(m,{onClick:()=>o(!1),sx:{backgroundColor:"#333"},children:e.jsx(se,{sx:{color:"white"}})})]}),e.jsxs("div",{className:"flex flex-wrap xl:flex-row flex-col flex-1 p-2",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Số QĐ kỉ luật: "}),e.jsx("input",{...y("soQD"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                    focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ ngày: "}),e.jsx("input",{...y("tungay"),type:"date",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến ngày: "}),e.jsx("input",{...y("denngay"),type:"date",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Người ký: "}),e.jsx("input",{...y("nguoiky"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-full flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Nội dung kỉ luật: "}),e.jsx("input",{...y("noidung"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Hình thức kỉ luật: "}),e.jsx(q,{control:B,name:"hinhthuc",render:({field:b})=>e.jsx(M,{options:[{label:"Tất cả",value:""},{label:"Khiển trách",value:"Khiển trách"},{label:"Cảnh cáo",value:"Cảnh cáo"},{label:"Hạ cấp bậc hàm",value:"Hạ cấp bậc hàm"},{label:"Tước quân tịch CAND",value:"Tước quân tịch CAND"}],className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Vui lòng chọn hình thức",...b})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Chi đoàn, liên chi đoàn: "}),e.jsx(q,{control:B,name:"nhomchidoanduockhenthuong",render:({field:b})=>e.jsx(M,{options:p,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Tất cả",...b})})]})]}),e.jsx("div",{className:"my-2 text-center",children:e.jsxs(T,{sx:{width:"200px",backgroundColor:"slategray"},type:"submit",color:"info",variant:"contained",children:[e.jsx(z,{})," Tìm kiếm"]})})]}),e.jsxs("div",{className:"mt-6 mx-8",children:[e.jsx("h3",{className:"text-center my-4 text-xl",children:"Danh sách kết quả kỉ luật cá nhân"}),e.jsxs("div",{className:"my-4",children:[e.jsxs("h4",{children:["Tổng số ",e.jsx("span",{className:"font-bold text-xl",children:D.length})," cá nhân bị kỉ luật. ",e.jsx("span",{className:"cursor-pointer underline text-blue-700",onClick:()=>X(!0),children:"Xem chi tiết"})]}),Y&&e.jsx("div",{className:"my-4","data-aos":"zoom-in-down","data-aos-once":"true",children:e.jsx(de,{list:D})})]}),e.jsx(ce,{list:s})]})]})};export{Re as default};
