import{r as u,j as e,d as R,u as V,m as W,Q as v}from"./index-af889cc1.js";import{d as A}from"./GridView-81a883b8.js";import"./index.esm-a80e06b2.js";import{u as $}from"./index.esm-c3d487d5.js";import{d as E}from"./Add-2c2882de.js";import{S as I,D as Q,a as K,h as G,d as J,b as U,c as X,f as Y,g as Z,e as ee}from"./DialogDelete-4539fb54.js";import{I as C,a as q,c as D,d as f,e as y,f as se,P as te,h as ae,i as re,j as le,k as oe,u as ne,l as w,m as O,n as B,o as _}from"./LastPage-dd44c61f.js";import{B as k}from"./Button-37b8afe6.js";import{s as ie}from"./ButtonBase-df984b9e.js";import{c as P}from"./chucvuApi-3ded1069.js";import"./createSvgIcon-c7fd463f.js";const ce=u.forwardRef(function(t,n){return e.jsx(I,{direction:"up",ref:n,...t})}),de=ie(C)({position:"absolute",right:"16px",top:"4px"});function ue({open:o,item:t,onCloseDialogEdit:n,onSubmit:l}){const{register:s,handleSubmit:r,control:c,resetField:h,setValue:b,watch:d,formState:{errors:a}}=$({defaultValues:{chucvu:"",thutu:1}});u.useState([]),u.useEffect(()=>{t&&(b("chucvu",t.chucvu,{shouldValidate:!0}),b("thutu",t.thutu,{shouldValidate:!0}))},[t]);const g=async j=>{if(l){const x={...j,id_edit:t._id};await l(x),n()}};return e.jsx(e.Fragment,{children:e.jsxs(Q,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(j,x)=>{x!=="backdropClick"&&n(j,x)},open:o,TransitionComponent:ce,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(K,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"rgb(30, 41, 59 )",margin:"0px"},children:[e.jsx(G,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa chức vụ công tác"}),e.jsx(de,{onClick:()=>n(),children:e.jsx(J,{style:{color:"white"}})})]}),e.jsx(U,{children:e.jsx(q,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:r(g),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Chức vụ: "]}),e.jsx("input",{...s("chucvu",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...s("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})}),e.jsx(X,{children:e.jsxs(k,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(E,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const he=({row:o,page:t,rowsPerPage:n,index:l,onClickOpenDialogEdit:s,onClickOpenDialogDelete:r})=>{u.useState(null);const c=R(h=>h.authReducer.roles_quanlydoanvien);return e.jsxs(D,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(f,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t*n+l}),e.jsx(f,{className:"border-r border-slate-300",align:"left",children:o.chucvu}),e.jsx(f,{className:"border-r border-slate-300",align:"left",children:o.thutu}),e.jsxs(f,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[c&&c.includes("sửa chức vụ")&&e.jsx(k,{variant:"contained",color:"info",size:"small",onClick:()=>s(o),children:e.jsx(Y,{style:{fontSize:"20px"}})}),c&&c.includes("xóa chức vụ")&&e.jsx(k,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>r(o._id),children:e.jsx(Z,{style:{fontSize:"20px"}})})]})]},o._id)};function z(o){const t=ne(),{count:n,page:l,rowsPerPage:s,onPageChange:r}=o,c=a=>{r(a,0)},h=a=>{r(a,l-1)},b=a=>{r(a,l+1)},d=a=>{r(a,Math.max(0,Math.ceil(n/s)-1))};return e.jsxs(q,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(C,{onClick:c,disabled:l===0,"aria-label":"first page",children:t.direction==="rtl"?e.jsx(w,{}):e.jsx(O,{})}),e.jsx(C,{onClick:h,disabled:l===0,"aria-label":"previous page",children:t.direction==="rtl"?e.jsx(B,{}):e.jsx(_,{})}),e.jsx(C,{onClick:b,disabled:l>=Math.ceil(n/s)-1,"aria-label":"next page",children:t.direction==="rtl"?e.jsx(_,{}):e.jsx(B,{})}),e.jsx(C,{onClick:d,disabled:l>=Math.ceil(n/s)-1,"aria-label":"last page",children:t.direction==="rtl"?e.jsx(O,{}):e.jsx(w,{})})]})}z.propTypes={count:y.number.isRequired,onPageChange:y.func.isRequired,page:y.number.isRequired,rowsPerPage:y.number.isRequired};function ge({list:o,onClickOpenDialogEdit:t,onClickOpenDialogDelete:n}){const[l,s]=u.useState(0),[r,c]=u.useState(10),h=l>0?Math.max(0,(1+l)*r-o.length):0,b=(a,g)=>{s(g)},d=a=>{c(parseInt(a.target.value,10)),s(0)};return e.jsxs(e.Fragment,{children:[e.jsx(se,{component:te,children:e.jsxs(ae,{"aria-label":"custom pagination table",children:[e.jsx(re,{children:e.jsxs(D,{children:[e.jsx(f,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(f,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Chức vụ"}),e.jsx(f,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Thứ tự"}),e.jsx(f,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(le,{children:[(r>0?o.slice(l*r,l*r+r):o).map((a,g)=>e.jsx(he,{row:a,page:l,rowsPerPage:r,index:g+1,onClickOpenDialogEdit:t,onClickOpenDialogDelete:n},a._id)),h>0&&e.jsx(D,{style:{height:53*h},children:e.jsx(f,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(oe,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:o.length,rowsPerPage:r,page:l,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:b,onRowsPerPageChange:d,ActionsComponent:z,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:g,to:j,count:x}){return`hiển thị ${g} đến ${j} bản ghi trong tổng số ${x!==-1?x:`more than ${j}`} bản ghi`}})})]})}const Te=()=>{const[o,t]=u.useState([]),n=V(),[l,s]=W(),[r,c]=u.useState({status:!1,item:null}),h=()=>{c({...r,status:!1})},b=i=>{c({item:i,status:!0})},[d,a]=u.useState({status:!1,id_Delete:null}),g=i=>{a({status:!0,id_Delete:i})},j=()=>{a({...d,status:!1})},x=()=>{a({...d,status:!1})},{register:N,handleSubmit:H,control:xe,resetField:S,watch:pe,formState:{errors:me}}=$({defaultValues:{chucvu:"",thutu:1}});u.useEffect(()=>{(async()=>{s(!0);try{let p=await P.getChucvus();t(p.data),setTimeout(()=>{s(!1)},400)}catch(p){p.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(n("/login"),s(!1),v.error(p.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(p.message)}})()},[]);const F=async i=>{let p={...i};s(!0);try{let m=await P.addChucvu(p);t(m.data.chucvuList),setTimeout(()=>{s(!1)},400),S("chucvu"),S("thutu"),v.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){v.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async i=>{let p={...i};s(!0);try{let m=await P.editChucvu(p);t(m.data.chucvuList),setTimeout(()=>{s(!1)},400),v.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){v.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},M=async()=>{s(!0);try{let i=await P.deleteChucvu(d.id_Delete);t(i.data.chucvuList),setTimeout(()=>{s(!1)},400),a({...d,status:!1}),v.success(i.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(i){a({...d,status:!1}),v.error(i.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},T=R(i=>i.authReducer.roles_quanlydoanvien);return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(A,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý chức vụ công tác"})]}),T&&T.includes("thêm chức vụ")&&e.jsxs("form",{className:"mt-2 mx-8",onSubmit:H(F),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Chức vụ: "]}),e.jsx("input",{...N("chucvu",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...N("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(k,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(E,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(ge,{list:o,onClickOpenDialogDelete:g,onClickOpenDialogEdit:b})}),e.jsx(ue,{open:r.status,item:r.item,onCloseDialogEdit:h,onSubmit:L}),e.jsx(ee,{open:d.status,onCloseDialogDelete:x,onConfirmDelete:M,onCancelDelete:j})]})};export{Te as default};
