import{r as h,d as R,j as e,u as V,m as W,Q as C}from"./index-af889cc1.js";import{d as A}from"./GridView-81a883b8.js";import"./index.esm-a80e06b2.js";import{u as q}from"./index.esm-c3d487d5.js";import{d as $}from"./Add-2c2882de.js";import{f as I,g as Q,S as K,D as G,a as J,h as U,d as X,b as Y,c as Z,e as ee}from"./DialogDelete-4539fb54.js";import{c as S,d as u,e as N,f as se,P as ae,h as te,i as le,j as re,k as ne,u as oe,a as z,I as y,l as B,m as O,n as w,o as _}from"./LastPage-dd44c61f.js";import{B as P}from"./Button-37b8afe6.js";import{b as v}from"./bachamApi-3268978e.js";import{s as ie}from"./ButtonBase-df984b9e.js";import"./createSvgIcon-c7fd463f.js";const de=({row:n,page:a,rowsPerPage:o,index:r,onClickOpenDialogEdit:s,onClickOpenDialogDelete:l})=>{h.useState(null);const d=R(m=>m.authReducer.roles_quanlydoanvien);return e.jsxs(S,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(u,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*o+r}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.bacham}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.nienhan}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.thutu}),e.jsxs(u,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[d&&d.includes("sửa bậc hàm")&&e.jsx(P,{variant:"contained",color:"info",size:"small",onClick:()=>s(n),children:e.jsx(I,{style:{fontSize:"20px"}})}),d&&d.includes("xóa bậc hàm")&&e.jsx(P,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>l(n._id),children:e.jsx(Q,{style:{fontSize:"20px"}})})]})]},n._id)};function E(n){const a=oe(),{count:o,page:r,rowsPerPage:s,onPageChange:l}=n,d=t=>{l(t,0)},m=t=>{l(t,r-1)},x=t=>{l(t,r+1)},c=t=>{l(t,Math.max(0,Math.ceil(o/s)-1))};return e.jsxs(z,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:d,disabled:r===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(B,{}):e.jsx(O,{})}),e.jsx(y,{onClick:m,disabled:r===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx(w,{}):e.jsx(_,{})}),e.jsx(y,{onClick:x,disabled:r>=Math.ceil(o/s)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx(_,{}):e.jsx(w,{})}),e.jsx(y,{onClick:c,disabled:r>=Math.ceil(o/s)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(O,{}):e.jsx(B,{})})]})}E.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function ce({list:n,onClickOpenDialogEdit:a,onClickOpenDialogDelete:o}){const[r,s]=h.useState(0),[l,d]=h.useState(10),m=r>0?Math.max(0,(1+r)*l-n.length):0,x=(t,p)=>{s(p)},c=t=>{d(parseInt(t.target.value,10)),s(0)};return e.jsxs(e.Fragment,{children:[e.jsx(se,{component:ae,children:e.jsxs(te,{"aria-label":"custom pagination table",children:[e.jsx(le,{children:e.jsxs(S,{children:[e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Cấp bậc hàm"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Niên hạn"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Thứ tự"}),e.jsx(u,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(re,{children:[(l>0?n.slice(r*l,r*l+l):n).map((t,p)=>e.jsx(de,{row:t,page:r,rowsPerPage:l,index:p+1,onClickOpenDialogEdit:a,onClickOpenDialogDelete:o},t._id)),m>0&&e.jsx(S,{style:{height:53*m},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(ne,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:n.length,rowsPerPage:l,page:r,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:x,onRowsPerPageChange:c,ActionsComponent:E,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:p,to:j,count:g}){return`hiển thị ${p} đến ${j} bản ghi trong tổng số ${g!==-1?g:`more than ${j}`} bản ghi`}})})]})}const ue=h.forwardRef(function(a,o){return e.jsx(K,{direction:"up",ref:o,...a})}),he=ie(y)({position:"absolute",right:"16px",top:"4px"});function me({open:n,item:a,onCloseDialogEdit:o,onSubmit:r}){const{register:s,handleSubmit:l,control:d,resetField:m,setValue:x,watch:c,formState:{errors:t}}=q({defaultValues:{bacham:"",nienhan:2,thutu:1,status:!0}});h.useState([]),h.useEffect(()=>{a&&(x("bacham",a.bacham,{shouldValidate:!0}),x("nienhan",a.nienhan,{shouldValidate:!0}),x("thutu",a.thutu,{shouldValidate:!0}))},[a]);const p=async j=>{if(r){const g={...j,id_edit:a._id};await r(g),o()}};return e.jsx(e.Fragment,{children:e.jsxs(G,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(j,g)=>{g!=="backdropClick"&&o(j,g)},open:n,TransitionComponent:ue,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(J,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"rgb(30, 41, 59 )",margin:"0px"},children:[e.jsx(U,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa bậc hàm"}),e.jsx(he,{onClick:()=>o(),children:e.jsx(X,{style:{color:"white"}})})]}),e.jsx(Y,{children:e.jsx(z,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:l(p),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Cấp bậc: "]}),e.jsx("input",{...s("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên bậc hàm tiếp theo tính theo năm: "]}),e.jsx("input",{...s("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...s("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx(Z,{children:e.jsxs(P,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx($,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const Te=()=>{const[n,a]=h.useState([]),o=V(),[r,s]=W(),[l,d]=h.useState({status:!1,item:null}),m=()=>{d({...l,status:!1})},x=i=>{d({item:i,status:!0})},[c,t]=h.useState({status:!1,id_Delete:null}),p=i=>{t({status:!0,id_Delete:i})},j=()=>{t({...c,status:!1})},g=()=>{t({...c,status:!1})},T=R(i=>i.authReducer.roles_quanlydoanvien),{register:k,handleSubmit:H,control:xe,resetField:D,watch:pe,formState:{errors:ge}}=q({defaultValues:{bacham:"",thutu:1,nienhan:2}});h.useEffect(()=>{(async()=>{try{s(!0);let f=await v.getBachams();a(f.data),setTimeout(()=>{s(!1)},400)}catch(f){f.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(o("/login"),s(!1),C.error(f.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(f.message)}})()},[]);const F=async i=>{let f={...i};s(!0);try{let b=await v.addBacham(f);a(b.data.bachamList),setTimeout(()=>{s(!1)},400),D("bacham"),D("nienhan"),D("thutu"),C.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(b){C.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async i=>{let f={...i};s(!0);try{let b=await v.editBacham(f);a(b.data.bachamList),setTimeout(()=>{s(!1)},400),C.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(b){C.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},M=async()=>{s(!0);try{let i=await v.deleteBacham(c.id_Delete);a(i.data.bachamList),setTimeout(()=>{s(!1)},400),t({...c,status:!1}),C.success(i.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(i){t({...c,status:!1}),C.error(i.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(A,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý Bậc quân hàm"})]}),T&&T.includes("thêm bậc hàm")&&e.jsxs("form",{className:"mt-2 mx-8",onSubmit:H(F),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên cấp bậc hàm: "]}),e.jsx("input",{...k("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên hàm tiếp theo: "]}),e.jsx("input",{...k("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...k("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(P,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx($,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(ce,{list:n,onClickOpenDialogDelete:p,onClickOpenDialogEdit:x})}),e.jsx(me,{open:l.status,item:l.item,onCloseDialogEdit:m,onSubmit:L}),e.jsx(ee,{open:c.status,onCloseDialogDelete:g,onConfirmDelete:M,onCancelDelete:j})]})};export{Te as default};
